## Service
это объект кубера для формирования единой постоянной точки входа в группу подов. Имеет постоянный ip:port, пока существует

![image](https://github.com/user-attachments/assets/ac948aa5-b9f0-4b42-b0e7-5df5161fd7f4)

## ClusterIP
нужен для того,чтобы достучаться до приложений, которые находятся в поде или деплойментв, но только в пределах кластера ( из инета достучаться нельзя )

Развернём 
<details> <summary>kuber-deployment.yaml</summary>

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber
  labels:
    app: kuber
spec:
  replicas: 3
  minReadySeconds: 5
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  selector:
    matchLabels:
      app: http-server
  template:
    metadata:
      labels:
        app: http-server
    spec:
      containers:
      - name: kuber-app
        image: bokovets/kuber:v1.0
        ports:
        - containerPort: 8000
```
</details>

и создаём service : ClusterIP

<details> <summary>clusterip-service.yaml</summary>

```
apiVersion: v1
kind: Service
metadata:
  name: kuber-service
spec:
  selector:             # селектор меток...
    app: http-server    # ...на основании которого сервис регистрирует к себе поды
  ports:
    - protocol: TCP
      port: 80          # порт самого сервиса
      targetPort: 8000  # порт контейнера ( был указан в kuber-deployment.yaml ( - containerPort: 8000) )
  type: ClusterIP       # вообще ClusterIP создаётся по-дефолту, можно не писать

```
</details>

![image](https://github.com/user-attachments/assets/7e9113e4-dedf-4c14-955b-2e52cc4bb807)

через ```kubectl get svc``` так же можно посмотреть

![image](https://github.com/user-attachments/assets/de21bf28-d92a-4a91-bec6-16e4ebf9b325)

внутри контейнера, очевидно, запрос отправляет, т.к ClusterIP взаимодействует внутри кластера 

![image](https://github.com/user-attachments/assets/dbff6d81-8f9c-4b38-b8bb-5c37ee188b18)

Отдельный под+сервис

<details> <summary>pod-service-port-names.yaml</summary>

```
apiVersion: v1
kind: Pod
metadata:
  name: kuber-app-manual
  labels:
    app: web-server
spec:
  containers:
  - name: kuber-app-image
    image: bokovets/kuber:v2.0
    ports:
    - name: http                 # имя можно любое задать, но нужно потом в service указать
      containerPort: 8000        # в поде может быть несколько контейнеров на разных портах, можно поменять хоть когда, service всё равно будет ссылаться на имя
    - name: https                # поэтому тут может быть хоть 10 портов
      containerPort: 8000        # но в примере приложение прослушивает только 8000 порт
---
apiVersion: v1
kind: Service
metadata:
  name: kuber-app-manual-service
spec:
  selector:
    app: web-server
  ports:
  - name: http
    port: 80
    targetPort: http           # будет роутить порт из пода с 1ым именем http, и будет ссылаться именно на имя, тут ничего менять не нужно
  - name: https
    port: 443
    targetPort: https          # будет роутить порт из пода со 2ым именем https

```
</details>
