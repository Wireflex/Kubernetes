# Secrets 
содержит секретные данные, и избавляет от необходимости включать пароли,токены итд в код приложения, могут быть использованы как:
- Файлы в Volume, смонтированные в 1 или нескольких контейнерах ПОДА
- Переменные окружения для контейнеров
- Kubelet может использовать секреты чтобы извлекать docker-image из приватных репозиториев

По умолчанию хранятся в API сервере в etcd в незашифрованном виде, в AWS, к примеру, будет шифроваться

Создадим 2 файла, над которыми и будем тестить 
```
echo -n 'admin' > ./username.txt
echo -n 'superpass12345&*' > ./password.txt
```

Создаём секрет с типом 'generic' и именем 'db-user-pass-from-file'

```
kubectl create secret generic db-user-pass-from-file \
  --from-file=./username.txt \
  --from-file=./password.txt
```

Зырим его ```kubectl get secret db-user-pass-from-file -o yaml```

![image](https://github.com/user-attachments/assets/f91d82ed-57e6-4a7b-b380-32b0208d44e1)

Это кодировка b-64

```
data:
  password.txt: c3VwZXJwYXNzMTIzNDUmKg==  
  username.txt: YWRtaW4=
```
Декодировка ```echo "c3VwZXJwYXNzMTIzNDUmKg==" | base64 -d```

![image](https://github.com/user-attachments/assets/8055b95e-7b1b-4155-b49b-e5dcc2f16f03)

В Lens так же можно декодировать ( на password тыкнул на зачеркнутый глаз )

![image](https://github.com/user-attachments/assets/490799e7-4a68-4cd7-9763-791137808b0b)

Можно создавать секреты напрямую, без файлов
```
kubectl create secret generic db-user-pass-from-literal \
  --from-literal=username=devuser \
  --from-literal=password='P!S?*r$zDsY'
```
Значения в Json-формате ```kubectl get secret db-user-pass-from-file -o jsonpath='{.data}'```

![image](https://github.com/user-attachments/assets/72fbbc35-9f1d-439e-8bc9-3939245dc822)

Декодировка только пароля ```kubectl get secret db-user-pass-from-literal -o jsonpath='{.data.password}' | base64 --decode```

![image](https://github.com/user-attachments/assets/90a0ffa8-5c23-4380-9300-a462874f3828)





<details> <summary>deploy1.yml</summary>

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber-1
  labels:
    app: kuber-1
spec:
  replicas: 1
  selector:
    matchLabels:
      app: http-server-1
  template:
    metadata:
      labels:
        app: http-server-1
    spec:
      containers:
      - name: kuber-app
        image: bakavets/kuber:v1.0
        ports:
        - containerPort: 8000
        envFrom:
        - secretRef:
            name: secret-data
```
</details>
