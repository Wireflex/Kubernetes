## Ingress
объект Kubernetes, описывающий правила проксирования трафика от внешнего источника до сервисов внутри кластера K8S, работает на прикладном уровне(http) может сохранять сессии, на основе файлов cookie(другие сервисы так не умеют ( они на транспортном уровне) )
```
minikube addons list
minikube addons enable ingress
```

в namespace 'kube-system' будет отображаться включенный ingress

![image](https://github.com/user-attachments/assets/d782981a-8f3f-4255-af95-818fc5a3840c)

Создадим 4 деплоймента, отличаются названиями имеджа,сервиса,имени

<details> <summary>deploy-svc-app-latest.yaml</summary>
  
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber
  labels:
    app: kuber
spec:
  replicas: 2
  selector:
    matchLabels:
      app: http-server
  template:
    metadata:
      labels:
        app: http-server
    spec:
      containers:
      - name: kuber-app
        image: bakavets/kuber
        ports:
        - containerPort: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: kuber-service
spec:
  selector:
    app: http-server
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8000
```

</details>

<details> <summary>deploy-svc-app-v1.yaml</summary>
  
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber-v1
  labels:
    app: kuber-v1
spec:
  replicas: 2
  selector:
    matchLabels:
      app: http-server-v1
  template:
    metadata:
      labels:
        app: http-server-v1
    spec:
      containers:
      - name: kuber-app
        image: bakavets/kuber:v1.0
        ports:
        - containerPort: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: kuber-service-v1
spec:
  selector:
    app: http-server-v1
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8000
```

</details>

<details> <summary>deploy-svc-app-v2.yaml</summary>
  
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber-v2
  labels:
    app: kuber-v2
spec:
  replicas: 2
  selector:
    matchLabels:
      app: http-server-v2
  template:
    metadata:
      labels:
        app: http-server-v2
    spec:
      containers:
      - name: kuber-app
        image: bakavets/kuber:v2.0
        ports:
        - containerPort: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: kuber-service-v2
spec:
  selector:
    app: http-server-v2
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8000

```

</details>

<details> <summary>deploy-svc-app-v3.yaml</summary>
  
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kuber-v3
  labels:
    app: kuber-v3
spec:
  replicas: 2
  selector:
    matchLabels:
      app: http-server-v3
  template:
    metadata:
      labels:
        app: http-server-v3
    spec:
      containers:
      - name: kuber-app
        image: bakavets/kuber:v3.0
        ports:
        - containerPort: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: kuber-service-v3
spec:
  selector:
    app: http-server-v3
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8000
```

</details>
